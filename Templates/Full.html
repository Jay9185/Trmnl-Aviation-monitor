<style>
  /* --- CRITICAL FIX: ROOT RESET --- */
  html, body {
    margin: 0; 
    padding: 0; 
    width: 100%; 
    height: 100%; 
    box-sizing: border-box;
    overflow: hidden; /* Hides scrollbars that cause white margins */
  }

  .trmnl-screen {
    width: 100%;
    height: 100%;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    display: flex;
    flex-direction: column;
    background-color: white;
    border: none;
    /* FIX: Lock container to top-left */
    position: absolute;
    top: 0;
    left: 0;
  }

  /* HEADER BAR */
  .header {
    background-color: black;
    color: white;
    padding: 6px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 800;
    font-size: 14px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    flex-shrink: 0;
  }

  /* TOP SECTION CONTAINER */
  .top-section {
    padding: 10px 15px; 
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    overflow: hidden; /* Prevents internal content from pushing width */
  }

  /* --- ROW 1: Callsign (Left) | Origin (Right) --- */
  .row-1 {
    display: flex;
    justify-content: space-between;
    align-items: flex-start; 
    margin-bottom: 5px;
    width: 100%;
  }

  .callsign {
    font-size: 90px; 
    font-weight: 900;
    letter-spacing: -3px;
    color: black;
    line-height: 0.85;
    margin-top: -5px;
    width: 38%; 
  }

  /* Right Side Route Group */
  .route-group {
    text-align: right;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    /* FIX: Reduced slightly from 62% to prevent sub-pixel rounding overflow */
    width: 60%; 
    flex-shrink: 0; 
  }

  .route-label {
    font-size: 11px;
    font-weight: 900;
    color: #888;
    text-transform: uppercase;
    margin-bottom: 2px;
    letter-spacing: 1px;
  }

  .route-city {
    font-size: 14px; 
    font-weight: 900;
    color: black;
    line-height: 1.15;
    text-transform: capitalize; 
    white-space: normal; 
    word-break: break-word; 
    overflow-wrap: break-word; 
    display: -webkit-box;
    -webkit-line-clamp: 3; 
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
  }

  /* --- ROW 2: Airline (Left) | Destination (Right) --- */
  .row-2 {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
    width: 100%;
  }

  .aircraft-info {
    font-size: 18px;
    font-weight: 900;
    text-transform: uppercase;
    color: black;
    display: flex;
    flex-direction: column; 
    line-height: 1.2;
    width: 38%; 
  }

  .ac-type { 
    font-size: 14px; 
    color: black; 
    font-weight: 900; /* FIXED: Corrected invalid 9000 value */
  }

  /* --- ROW 3: Metrics --- */
  .row-3 {
    display: flex;
    align-items: center;
    /* FIX: Changed gap to space-between for safer layout */
    justify-content: space-between; 
    border-top: 2px solid #eee;
    padding-top: 10px;
    width: 100%;
  }

  .dist-group { 
    font-size: 28px; 
    font-weight: 800;
    display: flex;
    flex-direction: row;
    align-items: baseline; 
    gap: 6px;
    line-height: 1;
  }
   
  .dist-label {
    font-size: 13px; font-weight: 900; color: black; text-transform: uppercase; letter-spacing: 0.5px;
  }

  .unit-sm { font-size: 16px; color: #444; font-weight: 700; margin-left: 2px; }

  .direction-box {
    background-color: black;
    color: white;
    font-weight: 900;
    padding: 3px 8px;
    font-size: 20px;
    border-radius: 2px;
    text-transform: uppercase;
  }

  .v-speed {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 24px;
    font-weight: 700;
    color: #333;
  }
  .arrow { font-size: 24px; color: #444; }

  /* --- FOOTER GRID --- */
  .footer-grid {
    background-color: #E0E0E0;
    border-top: 4px solid black;
    display: flex;
    height: 110px; 
    flex-shrink: 0;
  }

  .data-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-right: 2px solid #ccc; 
  }
  .data-col:last-child { border-right: none; }

  .data-label {
    font-size: 12px; font-weight: 800; text-transform: uppercase; color: #666; margin-bottom: 2px;
  }

  .data-val { font-size: 48px; font-weight: 900; color: black; letter-spacing: -2px; line-height: 1; }
  .data-unit { font-size: 16px; font-weight: 700; color: #444; margin-left: 2px; }

  .unit-degree { 
    font-size: 24px; 
    font-weight: 700; 
    color: #444; 
    margin-left: 2px;
    vertical-align: top; 
    line-height: 1;
  }
    
  .no-signal {
    width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center;
    font-size: 24px; font-weight: 800; color: #888;
  }
</style>

{% assign flight = merge_variables.flights | first %}

{% assign origin_name = flight.origin_full | default: "---" %}
{% assign dest_name = flight.destination_full | default: "---" %}

<div class="trmnl-screen">

  <div class="header">
    <span>PROXIMATE TRAFFIC</span>
    <span>{{ merge_variables.timestamp }} | {{ merge_variables.aircraft_count }} A/C</span>
  </div>

  <div class="top-section">
    {% if flight %}
        
      <div class="row-1">
        <span class="callsign">{{ flight.callsign }}</span>
        
        <div class="route-group">
          <span class="route-label">FROM</span>
          <span class="route-city">{{ origin_name }}</span>
        </div>
      </div>

      <div class="row-2">
        <div class="aircraft-info">
          <span>{{ flight.airline }}</span>
          <span class="ac-type">{{ flight.description | default: flight.aircraftType }}</span>
        </div>

        <div class="route-group">
          <span class="route-label">TO</span>
          <span class="route-city">{{ dest_name }}</span>
        </div>
      </div>

      <div class="row-3">
        <div class="dist-group">
          <span class="dist-label">DISTANCE</span>
          <span>{{ flight.distance }}<span class="unit-sm">nm</span></span>
        </div>
        
        <span class="direction-box">{{ flight.direction | default: "NE" }}</span>
        
        <div class="v-speed">
          {% if flight.verticalSpeed > 0 %}<span class="arrow">↑</span>
          {% elsif flight.verticalSpeed < 0 %}<span class="arrow">↓</span>{% endif %}
          <span>{{ flight.verticalSpeed | abs }}</span>
          <span class="unit-sm">fpm</span>
        </div>
      </div>

    {% else %}
      <div class="no-signal">SCANNING SKY...</div>
    {% endif %}
  </div>

  <div class="footer-grid">
    {% if flight %}
      <div class="data-col">
        <span class="data-label">Altitude</span>
        <div><span class="data-val">{{ flight.altitude }}</span><span class="data-unit">ft</span></div>
      </div>

      <div class="data-col">
        <span class="data-label">Speed</span>
        <div><span class="data-val">{{ flight.speed }}</span><span class="data-unit">kts</span></div>
      </div>

      <div class="data-col">
        <span class="data-label">Heading</span>
        <div>
          <span class="data-val">{{ flight.heading }}</span>
          <span class="unit-degree">°</span>
        </div>
      </div>
    {% endif %}
  </div>

</div>
